function y = newForward(freqType, numLayers, Rh, Zbed, Dip)
    % The forward model
    % freqType: chooses the frequency combinations. 
    % numLayers: number of layers
    % Rh: 1 x numLayers, resistivity vector
    % Zbed: 1 x numLayers-1, Zbed vector
    % Dip: scalar, the dip angle.
    TVD = 0;
    switch freqType % the unit is kHz
        case 1
            freqIDs = [2 6 24];
        case 2
            freqIDs = [2 24 100];
        case 3
            freqIDs = [2 6 48];
        case 4
            freqIDs = [2 12 48];
    end
    if freqType ~= 0
        y(1:24)  = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, freqIDs(1));
        y(25:48) = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, freqIDs(2));
        y(49:72) = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, freqIDs(3));
    else
        y(1:24)  = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, 2);
        y(25:48) = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, 6);
        y(49:72) = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, 12);
        y(73:96) = mexForward_new(numLayers, Rh, Rh, Zbed, TVD, Dip, 48);
    end
    global logY;
    if logY
        YMM = [-180,-46.8864790531334,-180,-24.9931407203536,-180,-44.3861630085701,-180,-79.2521328776093,-180,-44.6628333906627,-180,-13.3960370794582,-67.8675733079562,-16.6157283984897,-180,-27.4139476636952,-110.218281390450,-22.5293775757726,-41.3258159193760,-5.44895376498796,-55.1621484041965,-7.39109846800418,-15.1586947760382,-9.62020845488471,-180,-54.5174180520131,-180,-25.3786977870584,-180,-39.1311474141634,-180,-65.0553882606095,-180,-41.5491054250870,-180,-12.5125632875664,-62.7213087504014,-13.8704528803513,-180,-20.8750399569544,-134.167819456062,-24.3487206956514,-46.6126595735491,-6.63103401429405,-58.0187300113260,-9.39901692644424,-6.93109904666777,-11.7129115696957,-180,-60.2613956682109,-180,-16.4165288968469,-72.1287927486112,-24.6923835637165,-180,-30.5300995185240,-180,-31.1772033396857,-112.309959594988,-10.9905514916907,-62.8028922215141,-13.7142577294514,-6.47309092829658,-17.4367448008782,-142.722695251131,-24.4275487678937,-46.1353463312562,-4.34734159897668,-58.8225554910835,-11.0997534693924,-6.66059461609362,-11.8389424550536;
               180,63.1532175019394,180,71.3291912810811,180,27.9742554070470,180,27.1778646800691,180,42.7991370246600,180,64.5802254030664,74.0350524017550,15.3961776464952,180,10.5569551111687,118.785570736637,20.3709952735976,87.6367553280493,13.9874080095563,32.3927884204888,8.15645412512615,103.118567699614,4.54194237443391,180,60.3255697638886,180,47.9769092395581,180,27.3067603720191,180,32.4494926815132,180,35.2167793983776,180,41.6615184746591,60.5618511580134,13.0005742167706,180,8.74547064109267,136.546515438738,24.8836966686095,108.285225104686,20.7933812903099,38.7575710425159,9.75353227433378,117.196087528348,5.30914943888241,180,56.0026389820751,180,41.2788803353624,107.707320119665,17.4774906436317,180,6.74846819433498,180,42.3364898275208,165.425574946024,34.9643344522415,60.0477517789828,13.3864365139412,154.051312147826,3.83619632793909,136.791566188398,26.8206366513904,80.9793561515204,21.2009507110204,45.3871573887834,11.1597640218319,108.670113273248,3.38893489844741];
        y = geosteering_transform_y(y, YMM(1,:), YMM(2,:), zeros(1,72)-0.01, zeros(1,72)+0.01);
    end
end